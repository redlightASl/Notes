# HVL-硬件验证语言

Verilog HDL是20世纪90年代验证设计功能性的主要语言，但只对能一些小规模、低复杂度、特征量少的设计进行验证。随着设计复杂程度的提高，人们对更好的设计验证工具的需求程度也是渐渐增加，**硬件验证语言**随之而生，目前最流行的就是**System Verilog**，它是Verilog的超集，类似C++和C之间的关系。SV不仅包含了可综合的语句，而且还加入了许多Verilog无法提供的OOP和验证特性，允许EDA和工具库使用复杂的Testbench和随机激励覆盖来对设计进行验证

## Testbench的功能和基本组成模块

Testbench让我们通过仿真验证设计的功能。如果说Verilog RTL是一个电路，Testbench就是这个电路的探针（Probe）测试台。Testbench将待测设计（**DUT**）包裹起来，对其产生激励，并捕捉激励造成的响应。

> 待测设计即DUT（Design Under Test），基本是由VHDL/Verilog/SystemVerilog编写的可综合的RTL代码。在前端验证（流片前）中，常称为DUV（Design Under Verification）

在整个Testbench中，

* 生成激励的组件称为**生成器**（Generator）

    生成器可以产生有效的数据激励并将它们加到DUT上

* **监视器**（Monitor）检测DUT的端口来捕获设计的行为

    在DUT处理完输入数据并且将计算结果送至输出引脚后，**监视器**就负责获取数据激励对应的响应，将其转化为Testbench内部可以处理的数据类对象（Class Object）并将其送至计分板

* 与DUT直接交互的组件称为接口（Interface）

    如果DUT包含了一个乃至多个片上总线接口（比如AXI-Full），那么测试几乎是一个噩梦——维护、连接每一个片上总线都需要极大的工作量；但可以将设计中所有的端口都用一个容器包裹起来，这样就形成了**接口**，Testbench通过这个接口向DUT传输激励信号

* 一个**驱动器**（Driver）将激励信号驱动到DUT

    生成器固然可以产生激励信号并直接送进DUT，但在复杂设计中，Testbench使用的是SystemVerilog面向对象、不可综合的类库；而DUT本质上是由RTL实现的可综合电路，二者往往有不同的协议，这时候就需要一个驱动器来获取Testbench产生的数据对象并将其翻译成DUT可以理解的内容

* 使用**计分板**（Scoreboard）来检查输出和期望结果的一致性

    **计分板**内包含了一个和DUT有着相同行为方式的参考模型，该模型反映了对DUT期望的行为。激励信号被生成器同时送到参考模型，当DUT存在功能问题时，其输出结果一定和参考模型的结果不一致。之后比较二者就可以发现设计中的功能缺陷

* 整个Testbench利用**环境**（Environment）来实现可移植

    环境包括了很多类库供Testbench调用，从而让验证变得更灵活

